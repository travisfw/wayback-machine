<?xml version="1.0" encoding="ISO-8859-1"?>
<document>
	<properties>
		<author email="brad.AT.archive.DOT.org">Brad Tofel</author>
		<title>User Manual</title>
	</properties>
	<meta name="keyword" content="wayback machine, heritrix, java"/>
	<body>
		<section name="Introduction">
			<p>
				The Wayback Machine is a pure Java application that allows
				web browsers to access and search content stored in a set of ARC
				files.
			</p>
			<p>
				This manual provides basic information about downloading,
				installing, configuring and using the Wayback Machine.
			</p>
			<p>
				Setting up an instance of the Wayback Machine software will
				require several steps:
				<ol>
					<li>
						Preflight checklist: Do you have everything you need?
					</li>
					<li>
						Download the software.
					</li>
					<li>
						Determine how you will use the software.
					</li>
					<li>
						Install and Configure the software.
					</li>
					<li>
						Preparing your index data.
					</li>
					<li>
						Use the software.
					</li>
				</ol>
			</p>
		</section>
		<section name="Preflight Checklist">
			<p>
				Make sure you've satisfied all the 
				<a href="requirements.html">
					Requirements
				</a>
				first.
			</p>
		</section>
		<section name="Downloading">
			<p>
				Stable point releases of this software are available on 
				sourceforge.net. You can download the binary distribution of 
				the Wayback Machine via 
				<a href="http://sourceforge.net/project/showfiles.php?group_id=118427">
					this page
				</a>
				.
			</p>
			<p>
				You can find the latest version available from our continuous
				build box
				<a href="http://crawltools.archive.org:8080/cruisecontrol/buildresults/HEAD-archive-access">
					here
				</a>
			    .  Builds obtained here are not guaranteed stable.  Use
                with caution.
			</p>
			<p>
				Once you have downloaded the .tar.gz or .zip file from 
				sourceforge, you will need to unpack the file to access the
				webapp file, <b>wayback.war</b>.
			</p>
		</section>
		<section name="Determining how you will use the software">
			<subsection name="Choosing a Replay Mode">
				<p>
					The Wayback Machine provides two types of web browser-based
					access to the content in ARC files: Query access, and 
					Replay access.
				</p>
				<p>
					Query access allows users to locate	resources from the 
					ResourceStore matching a particular query. At present, the 
					only criteria that can be specified in queries to filter
					returned documents are URL based filters, and capture date.
					It is expected that in future releases of the Wayback 
					Machine, users will be able to locate documents via full 
					text search.
				</p>
				<p>
					Replay access allows users to actually view resources in the
					ResourceStore within their web browser. There are two Replay
					modes currently available with the Wayback Machine: 
					<b>Archival URL</b>, and <b>Proxy</b>.
				</p>
				<p>
					Before installing the Wayback Machine application, you will
					need to	choose which Replay mode you want to use. The two
					replay modes are described below.
				</p>
			</subsection>
			<subsection name="Archival URL Replay mode">
				<p>
					Archival URL Replay mode uses a modified URL to designate
					documents stored in ARC files. The general form of an 
					Archival URL is:
					<p>
						<code>
							http://HOSTNAME:PORT/CONTEXT/TIMESTAMP/URL
						</code>
					</p>
					where
					<ul>
						<li>
							HOSTNAME is the host where the Wayback Machine is
							running.
						</li>
						<li>
							PORT is the port where Tomcat is listening for 
							incoming HTTP requests.
						</li>
						<li>
							CONTEXT is the context where the Wayback Machine
							webapp has been deployed.
						</li>
						<li>
							TIMESTAMP is 0 to 14 digits of a date, possibly
							followed by an asterisk ('*'). The format of a 
							TIMESTAMP is:
							<p>
								<code>
									YYYYMMDDHHmmss
								</code>
							</p>
							where
							<ul>
								<li>
									YYYY represents a 4-digit year
								</li>
								<li>
									MM represents a 2-digit, 1-based month 
									(Jan = 1 - Dec = 12)
								</li>
								<li>
									DD represents a 2-digit day of the month
									(01-31)
								</li>
								<li>
									HH represents a 2-digit hour (01-24)
								</li>
								<li>
									mm represents a 2-digit minute (00-59)
								</li>
								<li>
									ss represents a 2-digit second (00-59)
								</li>
							</ul>
							The following are example dates expressed as 
							14-digit Timestamps:
							<p>
								Jan 13, 1999 03:34:35 (am GMT) - 19990113033435
							</p>
							<p>
								Dec 31, 2004 23:01:00 (pm GMT) - 20041231230100
							</p>
						</li>
						<li>
							URL represents the actual URL that should be 
							replayed.
						</li>
					</ul>
					<p>
						Here is an example Archival URL (on an assumed host 
						wayback-ng.archive.org) for	www.yahoo.com on Dec 31, 
						1999 at 12:00:00
						<p>
							<code>
								http://wayback-ng.archive.org/19991231120000/http://www.yahoo.com/
							</code>
						</p>
					</p>
					<p>
						Archival URL mode allows replay of all versions captured
						of a particul URL, by modifying the Timestamp. When an
						Archival URL Replay request is recieved for a URL, the
						Wayback Machine will replay the closest version in time
						to the Timestamp requested of the particular URL.
					</p>
					<p>
						HTML documents returned in Archival URL Replay mode are 
						modified from the original version to provide a replay 
						experience more consistant to viewing the original
						content. This is accomplished by the insertion of 
						Javascript, which executes in the client browser after 
						the page has loaded. This Javascript modifies most URLs
						within the HTML page, both Anchors (links) as well as
						embedded content (images, applets, etc) so that they 
						become appropriate requests back to the Wayback Machine.
					</p>
					<p>
						This Javascript is imperfect: sometimes requests 
						"leak" to the live web temporarily, before the 
						Javascript has executed. Also, not all URLs are 
						rewritten correctly, especially URLs that are created 
						by Javascript that was in the original page.
					</p>
				</p>
			</subsection>
			<subsection name="Proxy Replay mode">
				<p>
					Proxy Replay mode works by configuring a client browser to
					proxy all HTTP requests through the Wayback Machine 
					application. Instead of retrieving documents from the live
					web, the Wayback Machine will retrieve documents from the
					local repository of ARC files.
				</p>
				<p>
					Proxy Replay mode does not suffer from the shortcomings of
					the inserted Javascript that the Archival URL mode uses,
					but it has one major drawback: there is presently no way to
					specify which exact	version of a captured document should 
					be replayed. Only the URL to be replayed is sent from the 
					client browser to the Wayback Machine - no date information
					is sent with the request.
				</p>
				<p>
					In Proxy Replay mode, the Wayback Machine will return the 
					most recent version captured of any requested page. This 
					behavior can be changed by using the Firefox-specific plugin
					developed by Oskar Grenholm. You can find out more about 
					this plugin and download it 
					<a href="http://archive-access.sourceforge.net/projects/waxtoolbar/">
						here
					</a>.
				</p>
				<p>
				Thanks Oskar!
				</p>
			</subsection>
			<subsection name="Timeline Replay mode">
				<p>
					Timeline Replay mode provides an interface similar to the
					<a href="http://archive-access.sourceforge.net/projects/wera/">
						WERA
					</a>
					access tool, where a timeline is visible at the top of every
					page viewed in the Wayback. This timeline illustrates which
					versions are available, and provides the capability to
					access other versions of the same document, including the
					ability to scroll forwards and backwards in time.
				</p>
				<p>
					Timeline Replay mode is still under testing, and sites with
					frames may not work well. If you find problems with this 
					mode, please provide feedback via the archive-access 
					discussion list.
				</p>
			</subsection>
			<subsection name="Choosing a ResourceStore Implementation">
				<p>
					The Wayback Machine provides access to resources, which must
					(currently) be stored in a set of ARC files. The module that
					provides access for the Wayback Machine to this set of 
					resources is called the <b>ResourceStore</b>.
				</p>
				<p>
					There are two ResourceStore implementations you can 
					choose from, depending on how many ARC files you have and 
					where they are stored. If all your ARC files fit in a single
					directory, you can use the <b>LocalARCResourceStore</b>
					implementation, otherwise you will need to use the 
					<b>Http11ResourceStore</b> implementation. If you use the
					Http11ResourceStore, you will need to export your ARC files
					to the machine that will run the Wayback Machine webapp via
					HTTP 1.1. Some examples of HTTP 1.1 webservers you can use
					to export your ARC files are <b>Apache</b>, <b>Tomcat</b>, 
					and <b>thttpd</b>. Any other webserver that supports HTTP 
					1.1 will also work.
				</p>
			</subsection>
			<subsection name="Choosing a ResourceIndex Implementation">
				<p>
					In order to quickly search	for documents requested by 
					users, the Wayback Machine needs a list of all the resources
					stored in the ResourceStore. The module that provides access
					for the Wayback Machine to this list of resources is 
					called the <b>ResourceIndex</b>.
				</p>
				<p>
					Presently the only documented ResourceIndex implementation
					is the <b>LocalBDBResourceIndex</b>. Two other ResourceIndex
					implementations that communicate with remote index services
					have been developed. In both cases this communications 
					is based on HTTP queries that return XML to the Wayback 
					Machine. One implementation queries a NutchWAX full-text
					search engine, and the second communicates with a remote
					installation of the Wayback Machine itself. If you are 
					interested in using either of these implementations please 
					ask for more information on the discussion list.
				</p>
			</subsection>
		</section>
		<section name="Installing and Configuring">
			<p>
				Installation and configuration of this software involves the
				following steps:
				<ol>
					<li>
						placing .war file in appropriate location.
					</li>
					<li>
						choosing correct base web.xml file.
					</li>
					<li>
						customizing base web.xml file.
					</li>
					<li>
						restarting tomcat.
					</li>
				</ol>
			</p>
			<subsection name="Archival URL mode installation">
				<p>
					By default, the wayback.war file is configured to operate
					in Archival URL mode. It can be installed by simply placing
					the wayback.war file into Tomcat's <b>webapps/</b> 
					directory.
				</p>
				<p>
					If you need to run the Wayback Machine application in a
					context path besides <b>wayback</b>, you will need to rename
					the wayback.war file to <i>CONTEXT</i>.war before placing 
					it in the <b>webapps/</b> directory. When Tomcat deploys
                    the webapp, it will be accessible via <i>CONTEXT/</i>.
				</p>
			</subsection>
			<subsection name="Timeline mode installation">
				<p>
					This mode has the same procedure as Archival URL mode 
					installation. Please follow the instructions found there,
					but you will need to change the default web.xml file before
					using this mode.
				</p>
			</subsection>
			<subsection name="Proxy mode installation">
				<p>
					Running the Wayback Machine in proxy mode requires the
					webapp to run as the ROOT context, so you will need to 
					rename wayback.war to ROOT.war before placing it in the
					<b>webapps/</b> directory. If you have another ROOT webapp
					installed, you might want to move it out of the way before 
					putting the ROOT.war (which was originally wayback.war) 
					into place, but this is not required. If you do not move the
					old ROOT/ (and possibly the <i>old</i> ROOT.war) out of the
                    way, they may be overwritten when Tomcat deploys the new
                    ROOT webapp.
                    <ol>
						<li>
							shutdown Tomcat
						</li>
						<li>
							<i>(optionally)</i> move old ROOT/ and/or ROOT.war elsewhere.
						</li>
						<li>
							rename the wayback.war to ROOT.war in the webapps 
							directory (where TOMCAT_HOME is the path where you 
							installed Tomcat):
							<p>
								<code>
									mv wayback.war TOMCAT_HOME/webapps/ROOT.war
								</code>
							</p>
						</li>
						<li>
							start Tomcat. You will shutdown Tomcat again in
							a moment to configure the web.xml file, but for 
							now, we need Tomcat to unpack the .war file, 
							which requires a startup.
						</li>
					</ol>
				</p>
			</subsection>
			<subsection name="Choosing the base web.xml file">
				<p>
					Use the following table to decide which web.xml file you should
					use to begin configuring the Wayback software:
					<table>
						<tr>
							<td>
								Replay Mode \ ResourceStore
							</td>
							<td>
								LocalARCResourceStore
							</td>
							<td>
								Http11ResourceStore
							</td>
						</tr>
						<tr>
							<td>
								Archival Url Mode
							</td>
							<td>
								<b>web-local-archivalurl.xml</b>
							</td>
							<td>
								<b>web-http11-archivalurl.xml</b>
							</td>
						</tr>
						<tr>
							<td>
								Proxy Mode
							</td>
							<td>
								<b>web-local-proxy.xml</b>
							</td>
							<td>
								<b>web-http11-proxy.xml</b>
							</td>
						</tr>
						<tr>
							<td>
								Timeline Mode
							</td>
							<td>
								<b>web-local-timeline.xml</b>
							</td>
							<td>
								<b>web-http11-timeline.xml</b>
							</td>
						</tr>
					</table>
				</p>
			</subsection>
			<subsection name="Copying the correct web.xml into place">
				<p>
					Once Tomcat has deployed the CONTEXT.war (originally
                    wayback.war) the base web.xml file you picked in the 
                    <b>Choosing the base web.xml file</b> section will be 
                    unpacked at 
					<b>webapps/CONTEXT/WEB-INF/</b>.
				</p>
				<p>
					You need to copy the xml file you chose over the file
					<b>webapps/CONTEXT/WEB-INF/web.xml</b> with the command:
					<p>
					<code>
						cp webapps/CONTEXT/WEB-INF/web-PICKED.xml webapps/CONTEXT/WEB-INF/web.xml
					</code>
					</p>
					For example, if you chose the web-http11-archivalurl.xml, 
					you would use the command:
					<p>
					<code>
						<i>
							cp webapps/wayback/WEB-INF/web-http11-archivalurl.xml webapps/wayback/WEB-INF/web.xml
						</i>
					</code>
					</p>
					and if you chose the web-local-proxy.xml, you would use the 
					command:
					<p>
					<code>
						<i>
							cp webapps/ROOT/WEB-INF/web-local-proxy.xml webapps/ROOT/WEB-INF/web.xml
						</i>
					</code>
					</p>
				</p>
				<p>
					After you have copied the correct web-*.xml file into place,
					follow the customization steps below depending on the file 
					you picked, and then <b>restart Tomcat</b>.
				</p>
			</subsection>
			
			<subsection name="General configuration options">
				<p>
					All web.xml configuration files contain the following 
					configurations, which can be changed from the default values
					if needed.
				</p>
				<table>
					<tr>
						<td>
							Option
						</td>
						<td>
							Default value
						</td>
						<td>
							Description
						</td>
					</tr>
					<tr>
						<td>
							installationname
						</td>
						<td>
							<i>depends on base web.xml file chosen</i>
						</td>
						<td>
							This text will appear on the Wayback Configuration
							and Status page and may assist in determining which
							installation users are viewing via their web browser
							in environments with multiple Wayback installations.
						</td>
					</tr>
					<tr>
						<td>
							resourceindex.indexpath
						</td>
						<td>
							/tmp/wayback/index
						</td>
						<td>
							LocalBDBResourceIndex specific directory to store
							the BDB files. This directory must exist.
						</td>
					</tr>
					<tr>
						<td>
							resourceindex.dbname
						</td>
						<td>
							DB1
						</td>
						<td>
							LocalBDBResourceIndex specific name for BDB database
						</td>
					</tr>
					<tr>
						<td>
							indexpipeline.workpath
						</td>
						<td>
							/tmp/wayback/pipeline
						</td>
						<td>
							LocalBDBResourceIndex specific directory to store 
							flag files and temporary index data.
						</td>
					</tr>
					<tr>
						<td>
							indexpipeline.runpipeline
						</td>
						<td>
							1
						</td>
						<td>
							if set to '1' then a background indexing thread will
							automatically update the BDB index when new ARC 
							files are noticed in the 'arcpath' directory, or 
							when new flat-file index data is submitted from 
							remote ARC storage nodes. Any value besides '1' will
							cause the index to be static.
						</td>
					</tr>
				</table>
			</subsection>

			<subsection name="web-local-archivalurl.xml specific configuration">
				<p>
					The following table describes additional configurations 
					available in the web-local-archivalurl.xml file.
				</p>
				<table>
					<tr>
						<td>
							Option
						</td>
						<td>
							Default value
						</td>
						<td>
							Description
						</td>
					</tr>
					<tr>
						<td>
							replayuriprefix
						</td>
						<td>
							http://localhost:8080/wayback
						</td>
						<td>
							This should be set to the HTTP prefix to the wayback
							webapp context. You should set the hostname to the
							name of the machine where the Wayback Machine 
							software is runnning, the port to the port that 
							Tomcat is listening on, and 'wayback' should be the
							name of the context that the Wayback Machine webapp
							is deployed to (wayback.war => 'wayback' context,
							foo.war => 'foo' context).
						</td>
					</tr>
					<tr>
						<td>
							jsuri
						</td>
						<td>
							http://localhost:8080/wayback/wm.js
						</td>
						<td>
							This should be set to the absolute HTTP URL where
							the wm.js file is located. Most likely, you can
							follow the instructions for modifying the 
							<b>replayuriprefix</b>, but add "/wm.js" to the end.
						</td>
					</tr>
					<tr>
						<td>
							arcpath
						</td>
						<td>
							/tmp/wayback/arcs
						</td>
						<td>
							Directory where ARC files are found (possibly where 
							Heritrix writes them.) This directory must exist.
						</td>
					</tr>
				</table>
			</subsection>
			<subsection name="web-local-proxy.xml specific configuration">
				<p>
					The following table describes additional configurations 
					available in the web-local-proxy.xml file.
				</p>
				<table>
					<tr>
						<td>
							Option
						</td>
						<td>
							Default value
						</td>
						<td>
							Description
						</td>
					</tr>
					<tr>
						<td>
							arcpath
						</td>
						<td>
							/tmp/wayback/arcs
						</td>
						<td>
							Directory where ARC files are found (possibly where 
							Heritrix writes them.) This directory must exist.
						</td>
					</tr>
				</table>
			</subsection>
			<subsection name="web-local-timeline.xml specific configuration">
				<p>
					The following table describes additional configurations 
					available in the web-local-timeline.xml file.
				</p>
				<table>
					<tr>
						<td>
							Option
						</td>
						<td>
							Default value
						</td>
						<td>
							Description
						</td>
					</tr>
					<tr>
						<td>
							replayuriprefix
						</td>
						<td>
							http://localhost:8080/wayback/replay
						</td>
						<td>
							This should be set to the HTTP prefix to the wayback
							webapp context. You should set the hostname to the
							name of the machine where the Wayback Machine 
							software is runnning, the port to the port that 
							Tomcat is listening on, and 'wayback' should be the
							name of the context that the Wayback Machine webapp
							is deployed to (wayback.war => 'wayback' context,
							foo.war => 'foo' context).
						</td>
					</tr>
					<tr>
						<td>
							metauriprefix
						</td>
						<td>
							http://localhost:8080/wayback/meta
						</td>
						<td>
							This should be set to the HTTP prefix to the wayback
							webapp context. You should set the hostname to the
							name of the machine where the Wayback Machine 
							software is runnning, the port to the port that 
							Tomcat is listening on, and 'wayback' should be the
							name of the context that the Wayback Machine webapp
							is deployed to (wayback.war => 'wayback' context,
							foo.war => 'foo' context).
						</td>
					</tr>
					<tr>
						<td>
							timelineuriprefix
						</td>
						<td>
							http://localhost:8080/wayback/timeline
						</td>
						<td>
							This should be set to the HTTP prefix to the wayback
							webapp context. You should set the hostname to the
							name of the machine where the Wayback Machine 
							software is runnning, the port to the port that 
							Tomcat is listening on, and 'wayback' should be the
							name of the context that the Wayback Machine webapp
							is deployed to (wayback.war => 'wayback' context,
							foo.war => 'foo' context).
						</td>
					</tr>
					<tr>
						<td>
							frameseturiprefix
						</td>
						<td>
							http://localhost:8080/wayback/frameset
						</td>
						<td>
							This should be set to the HTTP prefix to the wayback
							webapp context. You should set the hostname to the
							name of the machine where the Wayback Machine 
							software is runnning, the port to the port that 
							Tomcat is listening on, and 'wayback' should be the
							name of the context that the Wayback Machine webapp
							is deployed to (wayback.war => 'wayback' context,
							foo.war => 'foo' context).
						</td>
					</tr>
					<tr>
						<td>
							jsuri
						</td>
						<td>
							http://localhost:8080/wayback/jsp/TimelineUI/wm-timeline.js
						</td>
						<td>
							This should be set to the absolute HTTP URL where
							the wm.js file is located. Most likely, you can
							follow the instructions for modifying the 
							<b>replayuriprefix</b>, but replace "replay" with 
							"/jsp/TimelineUI/wm-timeline.js".
						</td>
					</tr>
					<tr>
						<td>
							arcpath
						</td>
						<td>
							/tmp/wayback/arcs
						</td>
						<td>
							Directory where ARC files are found (possibly where 
							Heritrix writes them.) This directory must exist.
						</td>
					</tr>
				</table>
			</subsection>
			<subsection name="web-http11-archivalurl.xml specific configuration">
				<p>
					The following table describes additional configurations 
					available in the web-http11-archivalurl.xml file.
				</p>
				<table>
					<tr>
						<td>
							Option
						</td>
						<td>
							Default value
						</td>
						<td>
							Description
						</td>
					</tr>
					<tr>
						<td>
							replayuriprefix
						</td>
						<td>
							http://localhost:8080/wayback
						</td>
						<td>
							This should be set to the HTTP prefix to the wayback
							webapp context. You should set the hostname to the
							name of the machine where the Wayback Machine 
							software is runnning, the port to the port that 
							Tomcat is listening on, and 'wayback' should be the
							name of the context that the Wayback Machine webapp
							is deployed to (wayback.war => 'wayback' context,
							foo.war => 'foo' context).
						</td>
					</tr>
					<tr>
						<td>
							jsuri
						</td>
						<td>
							http://localhost:8080/wayback/wm.js
						</td>
						<td>
							This should be set to the absolute HTTP URL where
							the wm.js file is located. Most likely, you can
							follow the instructions for modifying the 
							<b>replayuriprefix</b>, but add "/wm.js" to the end.
						</td>
					</tr>
					<tr>
						<td>
							arcdbpath
						</td>
						<td>
							/tmp/wayback/arc-db
						</td>
						<td>
							Directory where the database containing the HTTP Url
							for each ARC files is stored. This directory must 
							exist.
						</td>
					</tr>
					<tr>
						<td>
							arcdbname
						</td>
						<td>
							arc-db
						</td>
						<td>
							Name of the database that stores ARC file locations.
						</td>
					</tr>
				</table>
			</subsection>
			<subsection name="web-http11-proxy.xml specific configuration">
				<p>
					The following table describes additional configurations 
					available in the web-http11-proxy.xml file.
				</p>
				<table>
					<tr>
						<td>
							Option
						</td>
						<td>
							Default value
						</td>
						<td>
							Description
						</td>
					</tr>
					<tr>
						<td>
							arcdbpath
						</td>
						<td>
							/tmp/wayback/arc-db
						</td>
						<td>
							Directory where the database containing the HTTP Url
							for each ARC files is stored. This directory must 
							exist.
						</td>
					</tr>
					<tr>
						<td>
							arcdbname
						</td>
						<td>
							arc-db
						</td>
						<td>
							Name of the database that stores ARC file locations.
						</td>
					</tr>
				</table>
			</subsection>
			<subsection name="web-http11-timeline.xml specific configuration">
				<p>
					The following table describes additional configurations 
					available in the web-http11-timeline.xml file.
				</p>
				<table>
					<tr>
						<td>
							Option
						</td>
						<td>
							Default value
						</td>
						<td>
							Description
						</td>
					</tr>
					<tr>
						<td>
							replayuriprefix
						</td>
						<td>
							http://localhost:8080/wayback/replay
						</td>
						<td>
							This should be set to the HTTP prefix to the wayback
							webapp context. You should set the hostname to the
							name of the machine where the Wayback Machine 
							software is runnning, the port to the port that 
							Tomcat is listening on, and 'wayback' should be the
							name of the context that the Wayback Machine webapp
							is deployed to (wayback.war => 'wayback' context,
							foo.war => 'foo' context).
						</td>
					</tr>
					<tr>
						<td>
							metauriprefix
						</td>
						<td>
							http://localhost:8080/wayback/meta
						</td>
						<td>
							This should be set to the HTTP prefix to the wayback
							webapp context. You should set the hostname to the
							name of the machine where the Wayback Machine 
							software is runnning, the port to the port that 
							Tomcat is listening on, and 'wayback' should be the
							name of the context that the Wayback Machine webapp
							is deployed to (wayback.war => 'wayback' context,
							foo.war => 'foo' context).
						</td>
					</tr>
					<tr>
						<td>
							timelineuriprefix
						</td>
						<td>
							http://localhost:8080/wayback/timeline
						</td>
						<td>
							This should be set to the HTTP prefix to the wayback
							webapp context. You should set the hostname to the
							name of the machine where the Wayback Machine 
							software is runnning, the port to the port that 
							Tomcat is listening on, and 'wayback' should be the
							name of the context that the Wayback Machine webapp
							is deployed to (wayback.war => 'wayback' context,
							foo.war => 'foo' context).
						</td>
					</tr>
					<tr>
						<td>
							frameseturiprefix
						</td>
						<td>
							http://localhost:8080/wayback/frameset
						</td>
						<td>
							This should be set to the HTTP prefix to the wayback
							webapp context. You should set the hostname to the
							name of the machine where the Wayback Machine 
							software is runnning, the port to the port that 
							Tomcat is listening on, and 'wayback' should be the
							name of the context that the Wayback Machine webapp
							is deployed to (wayback.war => 'wayback' context,
							foo.war => 'foo' context).
						</td>
					</tr>
					<tr>
						<td>
							jsuri
						</td>
						<td>
							http://localhost:8080/wayback/jsp/TimelineUI/wm-timeline.js
						</td>
						<td>
							This should be set to the absolute HTTP URL where
							the wm.js file is located. Most likely, you can
							follow the instructions for modifying the 
							<b>replayuriprefix</b>, but replace "replay" with 
							"/jsp/TimelineUI/wm-timeline.js".
						</td>
					</tr>
					<tr>
						<td>
							arcdbpath
						</td>
						<td>
							/tmp/wayback/arc-db
						</td>
						<td>
							Directory where the database containing the HTTP Url
							for each ARC files is stored. This directory must 
							exist.
						</td>
					</tr>
					<tr>
						<td>
							arcdbname
						</td>
						<td>
							arc-db
						</td>
						<td>
							Name of the database that stores ARC file locations.
						</td>
					</tr>
				</table>
			</subsection>
		</section>
		<section name="Preparing the ResourceIndex">
			<p>
				If you chose to use a ResourceIndex other than the 
				LocalBDBResourceIndex, preparation of the index data is not 
				covered by this manual.
			</p>
			<p>
				How to set up your ResourceIndex depends on whether you are
				using the LocalARCResourceStore or the Http11ResourceStore. In
				both cases, the actual index database files will be stored on
				the machine running the Wayback webapp. If you did not set the
				<b>indexpipeline.runpipeline</b> configuration to '1', then no
				updating of the ResourceIndex will occur. The rest of this 
				section assumes that the IndexPipeline is running.
			</p>
			<p>
				If you chose the LocalARCResourceStore, then the Wayback 
				software will automatically notice new ARC files appearing in
				the <b>arcpath</b> directory. When new ARC files appear, a
				plain-text index file for each ARC file will be created and
				placed in a special directory. The software will later merge 
				those plain-text index files into the BDB ResourceIndex. This 
				process may take some time. You can check on the status of this
				process via the Wayback Configuration and Status page (see 
				section below.)
			</p>
			<p>
				If you chose the Http11ResourceStore, then you will need to run
				an additional script on each machine that holds ARC files. For each
				ARC file found, this script will:
				<ol>
					<li>
						generate the plain-text index file for the ARC file
					</li>
					<li>
						push that plain-text file onto the machine running the
						Wayback webapp, where the ResourceIndex database is 
						stored. The plain-text index files will arrive in the 
						IndexPipeline directory structure so they are merged 
						into the ResourceIndex.
					</li>
					<li>
						notify the File LocationDB of the URL where the ARC file
						can be accessed, for later Replay requests which require
						access to documents in the ARC file.
					</li>
				</ol>
			</p>
			<p>
				This script can be found underneath the directory where	you 
				unpacked your distribution at:
				<b>
					bin/pipeline-client
				</b>.
				You will need to change permissions on this file to allow the
				script to be executed:
			</p>
			<p>
				<code>
					chmod a+x bin/pipeline-client
				</code>
			</p>
			<p>
				Then, execute the script once for each directory containing ARC
				files (on each machine containing ARC files.)
			</p>
			<p>
				<code>
					bin/index-arc TMP_DIR PIPELINE_URL LOCATION_URL ARC_DIR ARC_URL_PREFIX
				</code>
			</p>
			<p>
				where:
				<ul>
					<li>
						<i>
						TMP_DIR
						</i>
						is a location where the script can store temporary files
						ex. <b>/tmp/</b>
					</li>
					<li>
						<i>
						PIPELINE_URL
						</i>
						is the absolute URL where the pipeline status information
						is found.
						ex. <b>http://wayback-webapp.your-archive.org/wayback/pipeline/</b>
					</li>
					<li>
						<i>
						LOCATION_URL
						</i>
						is the absolute URL where the locationDB can be accessed.
						ex. <b>http://wayback-webapp.your-archive.org/wayback/locationDB</b>
					</li>
					<li>
						<i>
						ARC_DIR
						</i>
						The absolute path to the directory on the local machine
						which holds ARC files
						ex. <b>/2/arc-collection-1</b>
					</li>
					<li>
						<i>
						ARC_URL_PREFIX
						</i>
						is the absolute URL where the directory ARC_DIR can be
						accessed.
						ex. <b>http://arc-storage-node-1.your-archive.org/2/arc-collection-1/</b>
					</li>
				</ul>
			</p>
		</section>
		<section name="Using">
			<subsection name="Archival URL mode usage">
				<p>
					Once you have customized the web.xml file, restarted
					Tomcat, and prepared your ResourceIndex, the Wayback Machine
					installation will be ready for use.
				</p>
				<p>
					In any case, you can immediately visit the context path
					where you deployed the Wayback Machine webapp, at:
					<b>http://HOSTNAME:PORT/CONTEXT</b>, ex: 
					<i>http://yourhost.yourdomain.org:8080/wayback</i>.
					On this front page, you will find a link to the current 
					Configuration and Status page, which will also show you
					the status of the indexing pipeline.
				</p>
				<p>
					This status page includes 3 fields which indicate the status
					of the pipeline:
				</p>
				<table>
					<tr>
						<td>
							Field
						</td>
						<td>
							Meaning
						</td>
					</tr>
					<tr>
						<td>
							ARCs Queued For Index
						</td>
						<td>
							This number indicates how many new ARC files have 
							been noticed and are waiting to be processed to
							extract information for all documents contained in
							each ARC file.
						</td>
					</tr>
					<tr>
						<td>
							ARCs Queued For Merge
						</td>
						<td>
							This number indicates how many plain-text ARC file
							document index files are created and waiting to
							be added to the index.
						</td>
					</tr>
					<tr>
						<td>
							ARCs Merged
						</td>
						<td>
							This number indicates how many plain-text ARC file
							document index files have been added to the index.
							These documents are ready to be searched for and 
							served by the Wayback Machine.
						</td>
					</tr>
					
				</table>
				<p>
					You can search for pages in the index by typing the URL in
					the box 'Enter Web Address' and clicking "Take Me Back". To
					search for all pages within a website or website 
					sub-directory, or to search for pages between particular 
					dates, click the "Adv. Search" link.
				</p>
			</subsection>
			<subsection name="Proxy mode usage">
				<p>
					Before accessing the Wayback Machine using Proxy mode, you
					must configure the web browser that will access the service
					to proxy all HTTP requests through the webapp, using the 
					proxy URL which is the context path where you deployed the 
					Wayback Machine webapp, at:	<b>http://HOSTNAME:PORT/</b>, 
					ex: <i>http://yourhost.yourdomain.org:8080/</i>. For help on
					how to configure your browser to proxy HTTP requests through
					a proxy server, please consult the documentation for your
					web browser.
				</p>
				<p>
					You can access the Wayback Machine Query UI, which allows
					you to view the status of the server and query the index
					for documents, by pointing the browser at the same URL that 
					you configured as the proxy server. For information on 
					status, configurations and queries, please consult the 
					documentation for Using the Wayback Machine in Archival URL 
					mode. One common problem in Firefox Proxy configuration, you
					do not include the "http://" in the proxy server name.
				</p>
			</subsection>
			<subsection name="Timeline mode usage">
				<p>
					Once you have replaced and possibly customized the web.xml 
					file, restarted	Tomcat, and prepared your ResourceIndex, 
					the Wayback Machine	installation will be ready for use.
				</p>
				<p>
					You can start by visiting the front page of your Wayback
					service (see replayuriprefix in your web.xml file). Once you
					are at this page, you can type a URL into the search box
					near the top of the page, or use the Advanced Search page to
					perform more complex searches.
				</p>
				<p>
					Once you have located documents you would like to view with
					your searches, you can start using the Timeline mode by 
					clicking a link in the search results. This will load the
					timeline view for the specific page and time that you 
					selected. You can view different versions of any page by 
					clicking the timeline, and you can navigate to other pages
					in your collection by clicking links directly in the page
					below the timeline.
				</p>
				<p>
					By checking the "Metadata" box, you can view metadata 
					available for the particular document you are viewing. 
					Unchecking the box will return to normal view mode.
				</p>
			</subsection>
			
		</section>
	</body>
</document>
