<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"
       default-init-method="init">

<!--

    This file contains an alternate "8080:wayback" AccessPoint demonstrating
    several optional AccessPoint configurations.
-->

  <bean name="8080:wayback" class="org.archive.wayback.webapp.AccessPoint">
    <property name="collection" ref="localbdbcollection" />
    <property name="replay" ref="archivalurlreplay" />
    <property name="query">
      <bean class="org.archive.wayback.query.Renderer">
        <property name="captureJsp" value="/WEB-INF/query/CalendarResults.jsp" />
      </bean>
    </property>

    <property name="uriConverter">
      <bean class="org.archive.wayback.archivalurl.ArchivalUrlResultURIConverter">
        <property name="replayURIPrefix" value="http://localhost.archive.org:8080/wayback/"/>
      </bean>
    </property>

    <property name="parser">
      <bean class="org.archive.wayback.archivalurl.ArchivalUrlRequestParser">
        <property name="maxRecords" value="1000" />
        <property name="earliestTimestamp" value="1996" />
      </bean>
    </property>
    
    <!--
        The following configuration enables free String key-value pairs to be
        associated. These values can be used within customized .jsp UI files.
        Here is some example .jsp code demonstrating access of the "Institution"
        value:
            UIResults results = UIResults.getGeneric(request);
            String institution = results.getContextConfig("Institution");
            ...

    -->
    <property name="configs">
      <props>
        <prop key="Institution">Sample Institution</prop>
        <prop key="Collection">Sample Collection</prop>
      </props>
    </property>

    <!--
      The following is a rather complex configuration example demonstrating
      context specific AccessControl configuration. Specifically, it causes any
      request NOT originating INSIDE the 192.168.1.16/24 IP space to use the
      specified Access Control Oracle to determine which documents are 
      accessible. Requests originating INSIDE the IP space have no access 
      control restrictions.
    -->

    <property name="authentication">
      <bean class="org.archive.wayback.authenticationcontrol.AccessControlSettingOperation">
        <property name="operator">
          <bean class="org.archive.wayback.util.operator.NotBooleanOperator">
            <property name="operand">
              <bean class="org.archive.wayback.authenticationcontrol.IPMatchesBooleanOperator">
                <property name="allowedRanges">
                  <list>
                    <value>192.168.1.16/24</value>
                  </list>
                </property>
              </bean>
            </property>
          </bean>
        </property>
        <property name="factory">
          <bean class="org.archive.wayback.accesscontrol.oracleclient.OracleExclusionFilterFactory">
            <property name="oracleUrl" value="http://localhost:8180/oracle/" />
            <property name="accessGroup" value="ia_archiver" />
          </bean>
        </property>
      </bean>
    </property>
  </bean>

</beans>
